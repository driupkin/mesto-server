(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(5),c=a.n(r),i=(a(14),a(8)),s=a(1);a(15);var l=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("div",{className:"logo"}))};var u=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},m=o.a.createContext();var d=function(e){var t=o.a.useContext(m),a=e.card.owner._id===t._id,n=e.card.likes.some((function(e){return e._id===t._id}));return o.a.createElement("div",{className:"element"},o.a.createElement("button",{className:"element__trash ".concat(a?"element__trash_active":""),type:"button",onClick:function(){e.onCardDelete(e.card)}}),o.a.createElement("img",{src:"".concat(e.card.link),alt:"#",className:"element__image",onClick:function(){e.onCardClick(e.card)}}),o.a.createElement("div",{className:"element__title"},o.a.createElement("h2",{className:"element__paragraph"},e.card.name),o.a.createElement("div",{className:"like"},o.a.createElement("button",{className:"like__heart ".concat(n?"like__heart_active":""),type:"button",onClick:function(){e.onCardLike(e.card)}}),o.a.createElement("p",{className:"like__count"},e.card.likes.length))))};var p=function(e){var t=o.a.useContext(m);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile",id:""},o.a.createElement("div",{className:"profile__avatar_container",style:{backgroundImage:"url(".concat(t.avatar,")")}},o.a.createElement("div",{className:"profile__avatar_change",onClick:e.onEditAvatar})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__title"},o.a.createElement("h1",{className:"profile__name"},t.name),o.a.createElement("button",{type:"button",className:"profile__button-edit",onClick:e.onEditProfile})),o.a.createElement("p",{className:"profile__subtitle"},t.about)),o.a.createElement("button",{type:"button",className:"profile__button-add",onClick:e.onAddPlace})),o.a.createElement("section",{className:"elements"},e.cards.map((function(t,a){return o.a.createElement(d,{card:t,onCardLike:e.onCardLike,onCardClick:e.onCardClick,onCardDelete:e.onCardDelete,key:a})}))))};var h=function(e){return o.a.createElement("section",{className:"popup popup_cards ".concat(e.card?"popup_opened":"")},o.a.createElement("div",{className:"popup__container popup__container_card"},o.a.createElement("button",{type:"button",onClick:e.onClose,className:"popup__close popup__close_card"}),o.a.createElement("img",{src:"".concat(e.link),alt:"#",className:"popup__image"}),o.a.createElement("p",{className:"popup__subtitle"},e.name)))},f=a(6),_=a(7),E=function(){function e(t){var a=t.url,n=t.headers;Object(f.a)(this,e),this.url=a,this.headers=n}return Object(_.a)(e,[{key:"_handleResponse",value:function(e){return e.ok?e.json():(console.log("_handleResponse rejection"),Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}},{key:"_handleResponseError",value:function(e){return console.log("_handleResponseError"),Promise.reject(e.message)}},{key:"getData",value:function(){return fetch(this.url,{headers:this.headers}).then(this._handleResponse).catch(this._handleResponseError)}},{key:"editProfile",value:function(e){return fetch(this.url,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleResponse).catch(this._handleResponseError)}},{key:"addCard",value:function(e){return fetch(this.url,{method:"POST",headers:this.headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse).catch(this._handleResponseError)}},{key:"deleteCard",value:function(e){return fetch("".concat(this.url,"/").concat(e),{headers:this.headers,method:"DELETE"}).then(this._handleResponse).catch(this._handleResponseError)}},{key:"putLike",value:function(e){return fetch("".concat(this.url,"/likes/").concat(e),{headers:this.headers,method:"PUT"}).then(this._handleResponse).catch(this._handleResponseError)}},{key:"deleteLike",value:function(e){return fetch("".concat(this.url,"/likes/").concat(e),{headers:this.headers,method:"DELETE"}).then(this._handleResponse).catch(this._handleResponseError)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this.url,"/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse).catch(this._handleResponseError)}}]),e}(),v=new E({url:"https://mesto.nomoreparties.co/v1/cohort-13/users/me",headers:{authorization:"719abc6c-853b-49cf-a6ae-f91d269216f8","Content-Type":"application/json"}}),k=new E({url:"https://mesto.nomoreparties.co/v1/cohort-13/cards",headers:{authorization:"719abc6c-853b-49cf-a6ae-f91d269216f8","Content-Type":"application/json"}}),b=o.a.createContext();var N=function(e){return o.a.createElement("section",{className:"popup popup_".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__container popup__container_".concat(e.name)},o.a.createElement("form",{className:"form form_".concat(e.name),name:"popup_".concat(e.name),method:"GET",action:"#",onSubmit:e.onSubmit},o.a.createElement("button",{onClick:e.onClose,type:"button",className:"popup__close popup__close_".concat(e.name)}),o.a.createElement("h2",{className:"form__title form__title_".concat(e.name)},e.title),e.children,o.a.createElement("button",{type:"submit",className:"form__button form__button_".concat(e.name),onClick:e.onClose},e.buttonName))))};var C=function(e){var t=o.a.useState(""),a=Object(s.a)(t,2),n=a[0],r=a[1],c=o.a.useState(""),i=Object(s.a)(c,2),l=i[0],u=i[1],d=o.a.useContext(m);return o.a.useEffect((function(){r(d.name),u(d.about)}),[d]),o.a.createElement(N,{onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:n,about:l})},isOpen:e.isOpen,onClose:e.onClose,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:o.a.createElement("fieldset",{className:"form__field"},o.a.createElement("input",{value:n,name:"name",onChange:function(e){r(e.target.value)},placeholder:"\u0418\u043c\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"form__input form__input_name",type:"text",id:"name-input",required:!0,minLength:"2",maxLength:"40"}),o.a.createElement("span",{className:"form__input-error",id:"name-input-error"}),o.a.createElement("input",{value:l,name:"description",onChange:function(e){u(e.target.value)},placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",className:"form__input form__input_description",id:"description-input",type:"text",required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{className:"form__input-error",id:"description-input-error"}))})};var g=function(e){var t=o.a.useRef();return o.a.createElement(N,{onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},isOpen:e.isOpen,onClose:e.onClose,title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"change-avatar",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:o.a.createElement("fieldset",{className:"form__field"},o.a.createElement("input",{ref:t,name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",className:"form__input form__input_url",type:"url",id:"url-input",required:!0}),o.a.createElement("span",{className:"form__input-error",id:"url-input-error"}))})};var y=function(e){var t=o.a.useRef(),a=o.a.useRef();return o.a.createElement(N,{onSubmit:function(n){n.preventDefault(),e.onAddPlace({name:t.current.value,link:a.current.value})},isOpen:e.isOpen,onClose:e.onClose,title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-cards",buttonName:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:o.a.createElement("fieldset",{className:" form__field"},o.a.createElement("input",{ref:t,name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input form__input_place",type:"text",id:"place-input",required:!0,minLength:"1",maxLength:"30"}),o.a.createElement("span",{className:"form__input-error",id:"place-input-error"}),o.a.createElement("input",{ref:a,name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input form__input_url",type:"url",id:"url-input",required:!0}),o.a.createElement("span",{className:"form__input-error",id:"url-input-error"}))})};var O=function(){var e=o.a.useState(),t=Object(s.a)(e,2),a=t[0],n=t[1],r=o.a.useState(),c=Object(s.a)(r,2),d=c[0],f=c[1],_=o.a.useState(),E=Object(s.a)(_,2),N=E[0],O=E[1],R=o.a.useState(!1),L=Object(s.a)(R,2),S=L[0],j=L[1],P=o.a.useState({name:"",about:"",avatar:""}),w=Object(s.a)(P,2),x=w[0],A=w[1],D=o.a.useState([]),T=Object(s.a)(D,2),U=T[0],q=T[1];function J(){n(!1),f(!1),O(!1),j(!1)}return o.a.useEffect((function(){v.getData().then((function(e){A(e)})).catch((function(e){console.log(e)}))}),[]),o.a.useEffect((function(){k.getData().then((function(e){q(e)})).catch((function(e){console.log(e)}))}),[]),o.a.useEffect((function(){function e(e){e.target.classList.contains("popup_opened")&&J()}function t(e){"Escape"===e.key&&J()}return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}})),o.a.createElement(m.Provider,{value:x},o.a.createElement(b.Provider,{value:U},o.a.createElement("div",{className:"root"},o.a.createElement("div",{className:"page"},o.a.createElement(l,null),o.a.createElement(p,{cards:U,onCardLike:function(e){(e.likes.some((function(e){return e._id===x._id}))?k.deleteLike(e._id):k.putLike(e._id)).then((function(t){var a=U.map((function(a){return a._id===e._id?t:a}));q(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){k.deleteCard(e._id).then((function(){var t=U.filter((function(t){return t._id===e._id?"":t}));q(t)}))},onCardClick:function(e){j(e)},onEditAvatar:function(){n(!0)},onEditProfile:function(){f(!0)},onAddPlace:function(){O(!0)},setCards:q}),o.a.createElement(u,null)),o.a.createElement(C,{isOpen:d,onClose:J,onUpdateUser:function(e){v.editProfile(e).then((function(e){A(e)})).catch((function(e){console.log(e)}))}}),o.a.createElement(y,{isOpen:N,onClose:J,onAddPlace:function(e){k.addCard(e).then((function(e){return q([].concat(Object(i.a)(U),[e]))})).catch((function(e){console.log(e)}))}}),o.a.createElement(g,{isOpen:a,onClose:J,onUpdateAvatar:function(e){v.changeAvatar(e.avatar).then((function(e){A(e)})).catch((function(e){console.log(e)}))}}),o.a.createElement(h,{card:S,link:S.link,name:S.name,onClose:J}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){e.exports=a(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.64bd3d27.chunk.js.map